<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}AIæ‰‹ç´™ã‚¢ãƒ—ãƒª{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">
</head>
<body>
    {% block content %}{% endblock %}

    <!-- ğŸ”Š BGMã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
    <div id="bgm-controls" style="position: fixed; bottom: 10px; left: 10px; background: rgba(0,0,0,0.5); color: white; padding: 8px; border-radius: 10px;">
        ğŸµ <select id="musicSelect">
            <option value="/static/sound/bgm.mp3">é€šå¸¸BGM</option>
            <option value="/static/sound/sea.mp3">æµ·ã®éŸ³</option>
            <option value="/static/sound/forest.mp3">æ£®ã®éŸ³</option>
        </select>
        ğŸ”ˆ<input type="range" id="volume" min="0" max="1" step="0.01" value="0.3">
    </div>

    <script>
        // BGMå°‚ç”¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã
        if (!window.bgmWindow || window.bgmWindow.closed) {
            window.bgmWindow = window.open("/bgm", "bgmWindow", "width=1,height=1");
        }

        const volumeSlider = document.getElementById("volume");
        const musicSelect = document.getElementById("musicSelect");

        // åˆæœŸéŸ³é‡
        function sendToBgm(data){
            if(window.bgmWindow){
                window.bgmWindow.postMessage(data, "*");
            }
        }

        window.onload = () => {
            sendToBgm({type: "setVolume", value: volumeSlider.value});
            sendToBgm({type: "setMusic", value: musicSelect.value});
        };

        volumeSlider.addEventListener("input", () => {
            sendToBgm({type: "setVolume", value: volumeSlider.value});
        });

        musicSelect.addEventListener("change", () => {
            sendToBgm({type: "setMusic", value: musicSelect.value});
        });
    </script>
</body>
</html>